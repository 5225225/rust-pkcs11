language: rust
dist: bionic

os: linux

# Caching based off of https://levans.fr/rust_travis_cache.html
cache:
  directories:
    - /home/travis/.cargo
    - /home/travis/.rustup

before_cache:
  - rm -rf /home/travis/.cargo/registry

addons:
  apt:
    sources:
      - sourceline: "deb http://archive.ubuntu.com/ubuntu/ disco universe" # for libsofthsm2 2.4.0
    packages:
      - libsofthsm2

env:
  global:
    - PKCS11_SOFTHSM2_MODULE: /usr/lib/softhsm/libsofthsm2.so

script:
  - cargo build
  - cargo test
